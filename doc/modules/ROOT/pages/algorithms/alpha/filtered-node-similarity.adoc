[[algorithms-filtered-node-similarity]]
[.alpha]
= Filtered Node Similarity
:description: This section describes the Filtered Node Similarity algorithm in the Neo4j Graph Data Science library.

:entity: relationship
:result: similarity score
:algorithm: Filtered K-Nearest Neighbors

include::partial$/algorithms/alpha/alpha-note.adoc[]

:directed:
:undirected:
:homogeneous:
:heterogeneous:
:weighted:
include::partial$/algorithms/shared/algorithm-traits.adoc[]


[[algorithms-filtered-node-similarity-intro]]
== Introduction

The Filtered Node Similarity algorithm is an extension to the xref::algorithms/node-similarity.adoc[Node Similarity] algorithm.
It adds support for filtering on source nodes, target nodes, or both.


[[algorithms-filtered-node-similarity-node-filtering]]
== Node filtering

A node filter reduces the node space for which the algorithm will produce results.
Consider two similarity results: _A_ = `(alice)-[:SIMILAR_TO]->(bob)` and _B_ `(bob)-[:SIMILAR_TO]->(alice)`.
Result A will be produced if the `(alice)` node matches the source node filter and the `(bob)` node matches the target node filter
If the `(alice)` node does not match the target node filter, or the `(bob)` node does not match the source node filter, result *B* will not be produce.


[[algorithms-filtered-node-similarity-filter-configuration]]
== Configuring node filters

For the standard configuration of node similarity, see xref::algorithms/node-similarity.adoc#algorithms-node-similarity-syntax[Node Similarity syntax].

The source node filter is specified with the `sourceNodeFilter` configuration parameter.
The target node filter is specified with the `targetNodeFilter` configuration parameter.
Neither parameter is mandatory.

The node filter parameters accept one of the following:

.Syntax for `sourceNodeFilter` and `targetNodeFilter`
[cols="1,2a"]
|===
| a single node id
| `sourceNodeFilter: 42`
| a list of node ids
| `sourceNodeFilter: [23, 42, 87]`
| a single node
| `MATCH (person:Person) WITH person ORDER BY person.age DESC LIMIT 1` ... `sourceNodeFilter: n`
| a list of nodes
| `MATCH (person:Person) WHERE person.age > 35 collect(person) AS people` ... `sourceNodeFilter: people`
| a single label
| `sourceNodeFilter: 'Person'`
|===

[[algorithms-filtered-node-similarity-syntax]]
== Syntax

include::partial$/algorithms/shared/syntax-intro-named-graph.adoc[]

.Filtered Node Similarity syntax per mode
[.tabbed-example, caption = ]
====

[.include-with-stream]
======
.Run Filtered Node Similarity  in stream mode on a named graph.
[source, cypher, role=noplay]
----
CALL gds.alpha.nodeSimilarity.filtered.stream(
  graphName: String,
  configuration: Map
) YIELD
  node1: Integer,
  node2: Integer,
  similarity: Float
----

include::partial$/algorithms/common-configuration/common-parameters.adoc[]

.General configuration for algorithm execution on a named graph.
[opts="header",cols="3,2,3m,2,8"]
|===
| Name          | Type   | Default | Optional | Description
include::partial$/algorithms/common-configuration/common-stream-stats-configuration-entries.adoc[]
|===

:knnSpecificConfigurationTableTitle: Node Similarity specific configuration
include::partial$/algorithms/node-similarity/specific-configuration.adoc[]

include::partial$/algorithms/alpha/filtered-node-similarity/filtered-node-similarity-specific-algo-config.adoc[]

.Results
[opts="header",cols="1m,1,6"]
|===
| Name       | Type    | Description
| node1      | Integer | Node ID of the first node.
| node2      | Integer | Node ID of the second node.
| similarity | Float   | Similarity score for the two nodes.
|===
======
====
